<?xml version="1.0" encoding="utf-16"?>
<DesiredConfigurationDigest xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2009/07/10/DesiredConfiguration">
  <!--Authored against the following schema version: 5-->
  <OperatingSystem AuthoringScopeId="ScopeId_7520050B-F9BC-452E-AD92-210A44FC8FDE" LogicalName="LogicalName_622e69de-35a9-4ebd-9fd0-2860982cabdd" Version="4">
    <Annotation xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2009/06/14/Rules">
      <DisplayName Text="CMTrace - App Paths" ResourceId="ID-2c335da7-6335-422a-9921-6e5d79c4eeb7" />
      <Description Text="Adds CM Trace to App Paths" ResourceId="ID-d9807075-bda0-4d05-9b54-2791044ee071" />
    </Annotation>
    <Parts>
      <SuppressionReferences />
    </Parts>
    <Settings>
      <RootComplexSetting>
        <SimpleSetting LogicalName="ScriptSetting_2f99b197-68e1-46eb-a640-110ba673b387" DataType="String">
          <Annotation xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2009/06/14/Rules">
            <DisplayName Text="CMTrace - App Paths" ResourceId="ID-18b9ff75-4c80-43ec-b3e8-c2297d9b4904" />
            <Description Text="" />
          </Annotation>
          <ScriptDiscoverySource Is64Bit="true">
            <DiscoveryScriptBody ScriptType="PowerShell">if ((Get-ItemPropertyValue -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\cmtrace.exe" -Name '(default)') -eq "c:\windows\ccm\cmtrace.exe")
    {
    Write-Output "Compliant"
    }
else {
    Write-Output "Non-compliant"
    }</DiscoveryScriptBody>
            <RemediationScriptBody ScriptType="PowerShell">New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths" -Name 'cmtrace.exe' -ItemType Registry -ErrorAction SilentlyContinue
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\cmtrace.exe" -Name '(Default)' -Value "c:\windows\ccm\cmtrace.exe" -ErrorAction SilentlyContinue
New-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\cmtrace.exe" -Name 'Path' -PropertyType string -Value "c:\windows\ccm" -ErrorAction SilentlyContinue</RemediationScriptBody>
          </ScriptDiscoverySource>
        </SimpleSetting>
      </RootComplexSetting>
    </Settings>
    <Rules>
      <Rule xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2009/06/14/Rules" id="Rule_955187dd-1e62-4342-8454-15ed9d9d34d2" Severity="None" NonCompliantWhenSettingIsNotFound="false">
        <Annotation>
          <DisplayName Text="CMTrace - App Paths" ResourceId="ID-291067c9-fc26-4088-86d9-df64cb05ca48" />
          <Description Text="" />
        </Annotation>
        <Expression>
          <Operator>Equals</Operator>
          <Operands>
            <SettingReference AuthoringScopeId="ScopeId_7520050B-F9BC-452E-AD92-210A44FC8FDE" LogicalName="LogicalName_622e69de-35a9-4ebd-9fd0-2860982cabdd" Version="4" DataType="String" SettingLogicalName="ScriptSetting_2f99b197-68e1-46eb-a640-110ba673b387" SettingSourceType="Script" Method="Value" Changeable="true" />
            <ConstantValue Value="Compliant" DataType="String" />
          </Operands>
        </Expression>
      </Rule>
    </Rules>
    <OperatingSystemDiscoveryRule xmlns="http://schemas.microsoft.com/SystemsCenterConfigurationManager/2009/06/14/Rules">
      <OperatingSystemExpression>
        <Operator>OneOf</Operator>
        <Operands>
          <RuleExpression RuleId="Windows/All_x64_Windows_XP_Professional" />
          <RuleExpression RuleId="Windows/All_x86_Windows_XP" />
          <RuleExpression RuleId="Windows/x64_Windows_XP_Professional_SP2" />
          <RuleExpression RuleId="Windows/x86_Windows_XP_Professional_Service_Pack_3" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Vista" />
          <RuleExpression RuleId="Windows/All_x86_Windows_Vista" />
          <RuleExpression RuleId="Windows/x64_Windows_Vista_SP2" />
          <RuleExpression RuleId="Windows/x86_Windows_Vista_SP2" />
          <RuleExpression RuleId="Windows/All_x64_Windows_7_Client" />
          <RuleExpression RuleId="Windows/All_x86_Windows_7_Client" />
          <RuleExpression RuleId="Windows/x64_Windows_7_Client" />
          <RuleExpression RuleId="Windows/x64_Windows_7_SP1" />
          <RuleExpression RuleId="Windows/x86_Windows_7_Client" />
          <RuleExpression RuleId="Windows/x86_Windows_7_SP1" />
          <RuleExpression RuleId="Windows/All_x64_Windows_8_Client" />
          <RuleExpression RuleId="Windows/All_x86_Windows_8_Client" />
          <RuleExpression RuleId="Windows/All_x64_Windows_8.1_Client" />
          <RuleExpression RuleId="Windows/All_x86_Windows_8.1_Client" />
          <RuleExpression RuleId="Windows/All_x64_Windows_10_and_higher_Clients" />
          <RuleExpression RuleId="Windows/All_x86_Windows_10_and_higher_Clients" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Server_2003_Non_R2" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Server_2003_R2" />
          <RuleExpression RuleId="Windows/All_x86_Windows_Server_2003_Non_R2" />
          <RuleExpression RuleId="Windows/All_x86_Windows_Server_2003_R2" />
          <RuleExpression RuleId="Windows/x64_Windows_Server_2003_R2_SP2" />
          <RuleExpression RuleId="Windows/x64_Windows_Server_2003_SP2" />
          <RuleExpression RuleId="Windows/x86_Windows_Server_2003_R2_SP2" />
          <RuleExpression RuleId="Windows/x86_Windows_Server_2003_SP2" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Server_2008" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Server_2008_R2" />
          <RuleExpression RuleId="Windows/All_x86_Windows_Server_2008" />
          <RuleExpression RuleId="Windows/x64_Windows_Server_2008_R2" />
          <RuleExpression RuleId="Windows/x64_Windows_Server_2008_R2_CORE" />
          <RuleExpression RuleId="Windows/x64_Windows_Server_2008_R2_SP1" />
          <RuleExpression RuleId="Windows/x64_Windows_Server_2008_R2_SP1_Core" />
          <RuleExpression RuleId="Windows/x64_Windows_Server_2008_SP2" />
          <RuleExpression RuleId="Windows/x64_Windows_Server_2008_SP2_Core" />
          <RuleExpression RuleId="Windows/x86_Windows_Server_2008_SP2" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Server_8" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Server_2012_R2" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Server_2016" />
          <RuleExpression RuleId="Windows/All_Embedded_Windows_XP" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Embedded_8.1_Industry" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Embedded_8_Industry" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Embedded_8_Standard" />
          <RuleExpression RuleId="Windows/All_x86_Windows_Embedded_8.1_Industry" />
          <RuleExpression RuleId="Windows/All_x86_Windows_Embedded_8_Industry" />
          <RuleExpression RuleId="Windows/All_x86_Windows_Embedded_8_Standard" />
          <RuleExpression RuleId="Windows/x64_Embedded_Windows_7" />
          <RuleExpression RuleId="Windows/x86_Embedded_Windows_7" />
          <RuleExpression RuleId="Windows/All_x64_Windows_Server_2019_and_higher" />
        </Operands>
      </OperatingSystemExpression>
    </OperatingSystemDiscoveryRule>
  </OperatingSystem>
</DesiredConfigurationDigest>